
<html>
	<head></head>

	<body>
	<script src= "../js/element.js"> </script>
	<script src= "../js/style.js"> </script>
	<script src= "carbuncle.js"> </script>
	<script src= "carbuncle.compress.js"> </script>

	<script>
var zipme= function (a,b) { return a.map( function(e, i) { return [e, b[i]]; } ); };
		sing2.style(style).appendTo(sing.h);
		var div= sing2.div;
		var p= sing2.p;
		var mark= sing2.mark;

		var pre= preset().pushTo(sing.b).setcn('compress');

var sentence= function (x,n) { return {
	a: x[0],
	b: x[1],
	repr: function (par) {
		var d1= mark(this.a).appendTo(par).setcn('sentence');

		if (this.a==this.b) d1.setcn('incomplete');
		else {
			var d2= mark(this.b).setcn('meaning');
			pair(d1,d2);
		}
	}
}; };

var paragraph= function (x,n) {
	//alert(x);
	var par= div().appendTo(sing.b).setcn('par');
	//div('next').appendTo(par).setcn('next');
	var v= x.slice(0,3);
	if (v=="<im" || v=="<H3") {
	   return {
		   repr: function () {
		var g= function (x2,n2) { div(x2).appendTo(par).setcn('image'); };
		x.split('\n').map(g);
		   }
	   };
	}
	var f2= function (x,n) { return x.split('\n'); };
	var sx= x.split('\n\n').map(f2);
	var smx= zipme(sx[0],sx[1]).map(sentence);
	var parp= p().appendTo(par);
	mark('&emsp;').appendTo(parp).setcn('space');
	return {
		smx: smx,
		repr: function () { smx.map( function (x2,n2) { x2.repr(parp); } ); }
	};
};

var paragraphs= function (x,n) {
	//alert(x);
	return x.split('\n\n\n').map(paragraph);
};
div(carbuncle.title ).appendTo(sing.b).setcn('title');

var put= function (x,n) { pre.publish(div(x)); };
var a= [s1,s2,s3,s4,s5,s6,s7,s8,s9,s10].map( paragraphs );
//alert(1);
//var a= [s1].map( paragraphs );

var v= a.map ( function (x,n) {
	//alert(x);
	x.map( function (x2,n2) {
		x2.repr();
		//div('next').appendTo(sing.b).setcn('next');
	} );
});
	</script>
	</body>
</html>
